<!DOCTYPE html>
<html lang="ko">

<head>
  <!-- meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>탐라는제주 - 숨어 있던 진짜 hot한 제주</title>
  <link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico">
  <meta property="og:title" content="탐라는제주">
  <meta property="og:type" content="website">
  <meta property="og:description" content="탐라는제주 - 숨어 있던 진짜 hot한 제주">
  <!-- font -->
  <link rel="stylesheet" href="//cdn.rawgit.com/hiun/NanumSquare/master/nanumsquare.css">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB"
    crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt"
    crossorigin="anonymous">
  <!-- css -->
  <link rel="stylesheet" href="../../css/common.css" />
  <link rel="stylesheet" href="../../css/layout.css" />
  <link rel="stylesheet" href="../../css/travelist.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <!-- sweetArert2 -->
  <link rel="stylesheet" href="../../node_modules/sweetalert2/dist/sweetalert2.min.css">
  <link rel="stylesheet" href="../../node_modules/animate.css/animate.min.css">

</head>

<body>


  <header id="header"></header>


  <div id="container" class="container">
    <div id="visual">
    </div>
    <div id="content" class="content wrapper">


      <!-- <h3>색다르게 만나는 제주</h3>

      <p class="h3_txt">에메랄드 빛 바다와 한라산, 한라봉과 돌하르방. 혹은 제주도의 푸른 밤. 제주가 품고 있는 것은 이것만이 아니다. 제주의 문화와 역사를 알아가는 여행이나 제주의 속살을 들여다보는 지질생태여행은 제주를 깊게
        알게 해주고, 섬을 걷거나 느끼는 것만으로도 감성은 채워지고 마음이 힐링이 된다. 제주는 그래서 모두에게 선물 같은 존재다. 생각의 틀에서 벗어나 자유롭고 다양하게 제주를 여행하는 법을 안다면, 선물이
        주는 기쁨은 더 커지지 않을까.</p> -->

      <h4>내가 쓰는 여행기</h4>
      <p class="h4_txt">제주도의 아름다움을 담는 리뷰, 함께 볼까요?</p>


      <div class="board_list travelog">
        <div id="contnetList" class="box_wrap clear">

        </div>
        <!-- box_wrap end -->

        <div class="btn_wrap" style="text-align: end;">
          <button id='write' style="border: 1px solid #2793db; color: #2793db; background-color: white;" type="button" class="btn btn-primary">여행기작성</button>
        </div>
        <div class="pagination_wrap">
          <div id='pageBtn' class="pagination"></div>
          <!-- pagination end -->

        </div>
        <!-- pagination_wrap end-->

      </div>
      <!-- board_list end-->
    </div>
  </div>
  <!-- content end-->
  </div>
  <!-- container end-->
  <footer id="footer"></footer>


  <!-- js -->
  <script src="../../node_modules/handlebars/dist/handlebars.min.js"></script>
  <script src="../../node_modules/jquery/dist/jquery.min.js"></script>
  <script src="../../node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
  <script src="../../js/common/common.js"></script>
  <!-- sweetArert2 -->
  <script type="text/javascript" src="../../node_modules/sweetalert2/dist/sweetalert2.min.js"></script>




  <script type="text/javascript">
    $(document).ready(function () {
      $("#header").load("../include/sub_header.html")
      $("#footer").load("../include/sub_footer.html")
      /* id 지정을 통해서도 가능합니다. 
       $("#header").load("header.html #navbar")
       */
    });

    $(document).ready(function () {

      $.get(serverRoot + "/json/auth/islogin", {}, user => {
        var isLogins = decodeURIComponent(user);

        if (user != 'n') {
          $("#write").click(function () {
            location.href = 'travelog_form.html'
          })
        } else {
          $("#write").click(function () {
            swal({
              type: 'error',
              title: '로그인후 이용해주세요',
              // text: '로그인후 이용해주세요',
              showConfirmButton: false,
              timer: 1500
            })
          })
        }
      })




      $.ajax({

        type: "GET",

        url: serverRoot + "/json/travelLog/list",

        dataType: "JSON", // 옵션이므로 JSON으로 받을게 아니면 안써도 됨

        success: function (data) {
          var pageNo = data.length / 10;
          Math.ceil(pageNo)
          $('#pageBtn').append(
            "<a id='preBtn' href='#'>&laquo;</a>"
          )
          for (let i = 0; i < Math.ceil(pageNo); i++) {
            $('#pageBtn').append(
              "<a href='#' id='page_" + (i + 1) + "' class='pageNoBtns' onclick='pageClick(this)'>" + (i +
                1) + "</a>"
            )
          }
          $('#pageBtn').append(
            "<a id='nextBtn' href='#'>&raquo;</a>"
          )
          $('#page_1').trigger('click')

          $('#preBtn').click(function () {
            if ($('.active').prev()[0] != $('#preBtn')[0]) {
              $('.active').prev().trigger('click')
            }
          })

          $('#nextBtn').click(function () {
            if ($('.active').next()[0] != $('#nextBtn')[0]) {
              $('.active').next().trigger('click')
            }
          })

        }
      })

    })


    function pageClick(val) {
      var no = val.innerText;
      $('.pageNoBtns').removeClass('active')
      $(val).addClass('active')
      var memberId = [];





      $.ajax({

        type: "GET",

        url: serverRoot + "/json/travelLog/listpageNo=" + no,

        dataType: "JSON", // 옵션이므로 JSON으로 받을게 아니면 안써도 됨

        success: function (data) {

          var addData = data;

          $('#contnetList').empty();

          for (let i = 0; i < data.length; i++) {
            $('#contnetList').append(
              "<a href='travelog_view.html?" + data[i].tlno + "'>" +
              "<figure class='effect type02'>" +
              "<strong class='img_wrap'>" +
              "<img id='travelImg" + data[i].tlno +
              "' src='' alt=''>" +
              "<figcaption>" +
              "<h2>" + data[i].title + "</h2>" +
              "<p>View More</p>" +

              "</figcaption>" +
              "</strong>" +
              "<div class='travelog_cont'>" +

              "<span id='member_" + data[i].tlno + "' class='writer'>" +
              // "<img id=memberImg_"+data[i].tlno+">" +
              // "<span id='memberName_'"+data[i].tlno+" class='name'></span>" +
              "</span>" +
              "<span class='day' style='margin-bottom:10px;'>" + data[i].startDate + "-" + data[i].endDate +
              "</span>" +

              "<span class='hashtag' style='height:60px;' id='createDate_" + data[i].tlno + "'></span>" +
              "<ul>" +
              "<li>" +

              "<span>" +
              "<i class='far fa-eye'></i>조회수</span>" +
              "<b>"+data[i].count+"</b>" +
              "</li>" +
              "<li>" +

              "<span>" +
              "<i class='far fa-heart'></i>좋아요</span>" +
              "<b>23</b>" +
              "</li>" +
              "<li>" +

              "<span>" +
              "<i class='far fa-calendar-alt'></i>작성일</span>" +
              "<b id='createDate_" + data[i].tlno + "'>" + data[i].createDate + "</b>" +
              "</li>" +
              "</ul>" +
              "</div>" +
              "</figure>" +
              "</a>")
          }
          photoInsert()
          hashInsert()
          memberInsert()


          function photoInsert() {

            for (let i = 0; i < addData.length; i++) {

              $.ajax({

                type: "GET",

                url: serverRoot + "/json/travelLogContent/" + addData[i].tlno,

                dataType: "JSON", // 옵션이므로 JSON으로 받을게 아니면 안써도 됨

                success: function (data) {
                  $('#travelImg' + addData[i].tlno).attr('src', serverRoot + '/files/' + data[0].photo)


                }
              })
            }
          }

          function hashInsert() {

            for (let i = 0; i < addData.length; i++) {

              $.ajax({

                type: "GET",

                url: serverRoot + "/json/hashTag/" + addData[i].tlno,

                dataType: "JSON", // 옵션이므로 JSON으로 받을게 아니면 안써도 됨

                success: function (data) {
                  for (let j = 0; j < data.length; j++) {

                    $('#createDate_' + addData[i].tlno).append(
                      "<b>" + data[j].content + " <b>"
                    )
                  }

                }
              })
            }
          }

          function memberInsert() {

            for (let i = 0; i < addData.length; i++) {
              console.log(addData[i].id)

              $.ajax({

                type: "GET",

                url: serverRoot + "/json/member/" + addData[i].memberId,

                dataType: "JSON", // 옵션이므로 JSON으로 받을게 아니면 안써도 됨

                success: function (data) {

                  $('#member_' + addData[i].tlno).append(
                    "<img src=" + data.profileImg + ">" +
                    "<span class='name'>" + data.name + " </span>"
                  )
                  console.log(data.profileImg)
                  console.log(data[0].profileImg)


                }
              })
            }
          }



        }
      })
    }
  </script>
</body>

</html>